import React from 'react'
import Matchs from './Matchs'

class App extends React.Component {
  constructor(props) {
    super(props)
    this.unsubscribe = this.props.store.subscribe(this.update.bind(this))
  }
  update() {
    this.forceUpdate()
  }

  async componentDidMount() {
    const store = this.props.store //dispatchFetchAll(store)
  }

  async selectionChange(event) {
    console.log('selectionChange')
    console.log('done selectionChange')
  }

  matchDayChange(event) {
    console.log(event)
  }
  render() {
    const state = this.props.store.getState()
    if (state.isInitializing) {
      return <h2>Intializing...</h2>
    }
    if (state.isLoadingLeagues) {
      return <h2>Loading Leagues...</h2>
    }
    if (state.isLoadingYears) {
      return <h2>Loading Years...</h2>
    }
    if (state.isLoadingAllMatchDays) {
      return <h2>Loading Matchdays...</h2>
    }
    if (state.isLoadingTeams) {
      return <h2>Loading Teams...</h2>
    }
    if (state.isLoadingMatchDay) {
      return <h2>Loading Matchs...</h2>
    }
    console.log('render normal')
    return (
      <div className="container col-xs-8">
        <h1>{this.props.name}</h1>
        <select
          value={state.selectedLeague}
          className="form-control dropdown"
          onChange={this.selectionChange.bind(this)}
          id="league"
        >
          {state.leagues.map((l) => <option value={l.id}>{l.name}</option>)}
        </select>
        <select
          value={state.selectedYear}
          className="form-control dropdown"
          onChange={this.selectionChange.bind(this)}
          id="year"
        >
          {state.years.map((y) => <option value={y.id}>{y.name}</option>)}
        </select>
        <div className="row">
          <div className="col-xs-1">
            <button
              className="btn form-control"
              id="prevMatchDay"
              onClick={this.matchDayChange.bind(this)}
            >
              <span className="glyphicon glyphicon-chevron-left" />
            </button>
          </div>
          <div className="col-xs-8">
            <select //value={state.selectedMatchDay}
              className="form-control dropdown"
              onChange={this.selectionChange.bind(this)}
              id="group"
            >
              {state.matchDays.map((g) => (
                <option value={g.id}>{g.name}</option>
              ))}
            </select>
          </div>
          <div className="col-xs-1">
            <button
              className="btn form-control"
              id="nextMatchDay"
              onClick={this.matchDayChange.bind(this)}
            >
              <span className="glyphicon glyphicon-chevron-right" />
            </button>
          </div>
        </div>
        <div className="row col-xs-8">
          {state.matchs.length > 0
            ? state.matchs[0].LeagueName
            : 'Spieltaginfo'}
        </div>
        <Matchs matchs={state.matchs} teams={state.teams} />
      </div>
    )
  }
}

export default App
